{% nlgimport "common/suggests.nlg" %}
{% from "common/error.nlg" import render_error %}
{% from "common/macros.nlg" import get_alice_name with context %}

{% phrase render_error__system %}
  {{ render_error() }}
{% endphrase %}

{% phrase render_result %}
  {% if form.is_server_error %}
    {% chooseline %}
        Что-то пошло не так. Давайте познакомимся в другой раз.
        Извините, сервер плохо себя ведёт. Придётся нам отложить знакомство.
        Небольшие технические шоколадки{% tx %}...{% etx %}{% vc %} -{% evc %} тьфу{% tx %},{% etx %}{% vc %} -{% evc %} неполадки. Давайте познакомимся позже.
    {% endchooseline %}
  {% else %}
    {% if is_active_attention('invalid_region') %}
      {% chooseline %}
        Сценарий «Запомни мой голос» не доступен в вашем регионе.
        Вы мне нравитесь, но я пока не смогу запомнить ваше имя в этом регионе.
      {% endchooseline %}
    {% else %}
      {% if form.is_username_error %}
        {% chooseline %}
            Видимо, не лучший день для знакомств. Давайте в другой раз. Эх!
            Видимо, сегодня не мой день. Давайте в другой раз познакомимся.
            Мы обязательно познакомимся, но, кажется, не сегодня.
        {% endchooseline %}
      {% else %}
        {% if form.is_too_many_enrolled_users %}
          {% if form.is_change_name %}
            Я могу изменить имя пользователя, голос которого я уже знаю, а ваш голос мне не {% vc %}знак+ом{% evc %}{% tx %}знаком{% etx %}.
          {% else %}
            {% if is_active_attention("known_user") %}
              {% chooseline %}
                Мы с вами уже знакомились. Если хотите изменить имя, скажите: «{{ get_alice_name() }}, называй меня...» — и добавьте новое.
                А я вас уже знаю. Если хотите изменить имя, скажите: «{{ get_alice_name() }}, называй меня...» — и добавьте новое.
              {% endchooseline %}
            {% else %}
              {% chooseline %}
                Пока я умею запоминать только один голос на устройстве. Увы.
                Пока я умею запоминать только один голос на устройстве. Простите.
              {% endchooseline %}
            {% endif %}
          {% endif %}
        {% else %}
          {% if form.is_need_login %}
            {% chooseline %}
              Мне можно знакомиться только с зарегистрированными пользователями. Пожалуйста, войдите в свой аккаунт в приложении Яндекс.
              Программист Алексей разрешил знакомиться только с проверенными пользователями. Пожалуйста, войдите в свой аккаунт в приложении Яндекс.
            {% endchooseline %}
          {% else %}
            {% if form.created_uid %}
              {% chooseline %}
                  Очень приятно, {{ form.user_name|capitalize }}. Теперь я буду вас узнавать. Если вам это надоест, скажите: «{{ get_alice_name() }}, забудь мой голос». А пока — небольшая проверка. Спросите: «{{ get_alice_name() }}, как меня зовут?»
                  Рада познакомиться, {{ form.user_name|capitalize }}. Теперь я знаю ваш голос. Чтобы всё отменить, скажите: «{{ get_alice_name() }}, забудь мой голос». А пока — небольшая проверка. Спросите: «{{ get_alice_name() }}, как меня зовут?»
                  Очень приятно, {{ form.user_name|capitalize }}. Теперь я буду вас узнавать. Если вам надоест дружить со мной так близко, скажите: «{{ get_alice_name() }}, забудь мой голос». А сейчас — проверка. Спросите: «{{ get_alice_name() }}, как меня зовут?»
                  Очень приятно, {{ form.user_name|capitalize }}. У вас отличный голос. Если вам захочется снова стать незнакомцем, скажите: «{{ get_alice_name() }}, забудь мой голос». А сейчас — проверка. Спросите: «{{ get_alice_name() }}, как меня зовут?»
                {% endchooseline %}
            {% else %}
              {% chooseline %}
                Нет проблем. Если  надумаете знакомиться, просто скажите: «{{ get_alice_name() }}, запомни мой голос».
                Как хотите. Если передумаете, скажите: «{{ get_alice_name() }}, запомни мой голос».
                Окей. Если передумаете, скажите: «{{ get_alice_name() }}, запомни мой голос».
              {% endchooseline %}
            {% endif %}
          {% endif %}
        {% endif %}
      {% endif %}
    {% endif %}
  {% endif %}
{% endphrase %}
