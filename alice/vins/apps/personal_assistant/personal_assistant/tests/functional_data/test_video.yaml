labels:
  video_autoplay: '(Включаю|Запускаю|Сейчас включу|Секунду|Секундочку)\.'
  payment_confirmed: '.*\b(продолжить оплату|платный|[Пп]родолжите оплату|оплатить фильм|ссылка на оплату)\b.*'
  show_description: '.*\b([Оо]писание|подробную информацию|подробная информация|секунду)\b.*'
  payment_confirmed_dont_need_to_buy: '.*\b[Уу]же\b.*'
  paid_content: '.*\b(платный контент|контент платный)\b.*\bописание\b.*'
  show_gallery: '.*\b([Сс]екунд(очк)?у|нашлось|найти|поищем)\b.*'
  show_season_gallery: '.*\b(Открываю|Секунд(очк)?у|Сейчас открою)\b.*'
  no_such_season: '.*\b[Сс]езона\b.*\bнет\b.*'
  no_such_episode: '.*\b[Сс]ерии\b.*\bнет\b.*'
  non_authorized: '.*\b(необходимо авторизоваться)\b.*'
  failed_to_send_push: '.*\b(отправить пуш-сообщение).*'
  video_sent_auth_push: 'Чтобы всё получилось, нужно авторизоваться\. Для этого я отправлю вам сообщение\. Проверьте телефон\!'
  video_payment_push: '.*([Пп]родолжит[ье] оплату|оплатить фильм|ссылка на оплату).*'
  westworld_play: '( Надеюсь, хоть вы\-то не андроид\.)?'
  no_relevant_video: '.*что-то, чем ничего.*|.*нет этого видео.*|.*не нашла такого.*'
  all_results_filtered: '.*\b(детский режим|детским режимом)\b.*'
  provider_is_forbidden_for_family_search: '.*\b(Амедиатеке|18+)\b.*'
  leet: '.*1337.*'
  please_connect_tv: 'Чтобы смотреть .* подключ.* Станцию к экрану\.'
  video_error_purchase_not_found: 'Это платный контент.'
  video_error_purchase_expired: '(Истёк срок аренды фильма\.|Срок аренды фильма закончился\.|Срок аренды контента закончился\.)'
  video_error_service_constraint_violation: 'На этом устройстве контент недоступен. Извините.'
  video_error_subscription_not_found: '(Этот контент доступен только по|Для просмотра нужна|У вас нет) подписк[еаи] Яндекс\.Плюс\.'
  video_error_geo_constraint_violation: 'Просмотр в этом регионе ограничен\. Так решил правообладатель\.'
  video_error_licenses_not_found: 'Доступ к контенту закрыт\. Увы, так решил правообладатель\.'
  video_error_supported_streams_not_found: 'Не могу включить фильм на этом устройстве — не та версия\.'

app_info:
  app_id: 'ru.yandex.quasar.vins_test'
  app_version: '1.0'
  os_version: '6.0.1'
  platform: 'android'

device_state:
    is_tv_plugged_in: true


test_show_gallery_nlg:
    что мне посмотреть:
      bass:
        blocks:
          - type: attention
            attention_type: video_gallery
      text: 'Видео-контент'
      voice: '{show_gallery}'

    посоветуй что-нибудь посмотреть про собак:
      bass:
        blocks:
          - type: attention
            attention_type: video_gallery
      text: 'Видео-контент по запросу «про собак»'
      voice: '{show_gallery}'

    фильмы:
      vins_form:
        name: 'personal_assistant.scenarios.video_play'
      bass:
        blocks:
          - type: attention
            attention_type: video_gallery
      text: 'Фильмы'
      voice: '{show_gallery}'

    фильмы про собак:
      bass:
        blocks:
          - type: attention
            attention_type: video_gallery
      text: 'Фильмы по запросу «про собак»'
      voice: '{show_gallery}'

    комедии:
      bass:
        blocks:
          - type: attention
            attention_type: video_gallery
      text: 'Комедии'
      voice: '{show_gallery}'

    найди комедию ананасовый экспресс:
      bass:
        blocks:
          - type: attention
            attention_type: video_gallery
      text: 'Комедии по запросу «ананасовый экспресс»'
      voice: '{show_gallery}'

    новинки кино:
      bass:
        blocks:
          - type: attention
            attention_type: video_gallery
      text: '{show_gallery}'
      voice: '{show_gallery}'

    включи звездные войны:
      bass:
        blocks:
          - type: attention
            attention_type: video_gallery
      text: 'Видео-контент по запросу «звездные войны»'
      voice: '{show_gallery}'

test_country:
  порекомендуй японских мультиков:
    vins_form:
      name: 'personal_assistant.scenarios.video_play'
      slots:
        action:
          value: recommend
        country:
          value: япония
        content_type:
          value: cartoon
    bass:
      blocks:
        - type: attention
          attention_type: video_gallery
    text: '{show_gallery}'
    voice: '{show_gallery}'

test_top_video:
  что рекомендуешь посмотреть из топчика:
    vins_form:
      name: 'personal_assistant.scenarios.video_play'
      slots:
        action:
          value: recommend
        top:
          value: top_video
    bass:
      blocks:
        - type: attention
          attention_type: video_gallery
    text: '{show_gallery}'
    voice: '{show_gallery}'


test_content_provider:
  включи терминатор на хдрезке:
    vins_form:
      name: 'personal_assistant.scenarios.video_play'
      slots:
        action:
          value: play
        content_provider:
          value: 'хдрезке'
        search_text:
          value: 'терминатор'
    bass:
      blocks:
        - type: 'attention'
          attention_type: 'video_autoplay'

    text: '{video_autoplay}'

  найди фарго на кинопоиске:
    vins_form:
      name: 'personal_assistant.scenarios.video_play'
      slots:
        action:
          value: find
        content_provider:
          value: kinopoisk
        search_text:
          value: фарго

  поищи боевички в сети:
    vins_form:
      name: 'personal_assistant.scenarios.video_play'
      slots:
        action:
          value: find
        content_provider:
          value: yavideo
        film_genre:
          value: action


test_navigation_commands:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'gallery'

  dialog:
    вперед:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.go_forward'

    вернись назад:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.go_backward'

    закрыть:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.go_backward'

    закрой это:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.go_backward'

    перейди в начало:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.go_to_the_beginning'

    в самый конец:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.go_to_the_end'

    давай домой:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.go_home'

    домой:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.go_home'

    алиса домой:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.go_home'

    главный экран:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.go_home'

    главное меню:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.go_home'

    домашняя страница:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.go_home'

    перейди на главную страницу:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.go_home'

    открой заглавную страницу:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.go_home'

    давай на начальную страницу:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.go_home'


test_go_home_without_screen_with_player:
  experiments: [vins_pause_commands_relevant_again]
  device_state:
    is_tv_plugged_in: false
    radio:
      player:
        pause: false
      currently_playing: some_station
  dialog:
    домой:
      vins_form:
        name: personal_assistant.scenarios.player_pause


test_go_home_aliced:
  app_info:
    app_id: 'aliced.vins_test'
    app_version: '1.2.3'
    os_version: '0'
    device_manufacturer: 'Irbis'
    platform: 'linux'
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'music_player'
  dialog:
    домой:
      vins_form:
        name: personal_assistant.scenarios.quasar.go_home


test_no_such_season:
  включи 10 серию 20 сезона сериала друзья:
    vins_form:
      name: 'personal_assistant.scenarios.video_play'
      slots:
        season:
          value: 20
        episode:
          value: 10
        content_type:
          value: tv_show
        search_text:
          value: 'друзья'
        action:
          value: 'play'

    bass:
      blocks:
        - type: 'attention'
          attention_type: 'no_such_season'

    text: '{no_such_season}'


test_no_such_episode:
  найди 100 серию 1 сезона сериала lost:
    vins_form:
      name: 'personal_assistant.scenarios.video_play'
      slots:
        season:
          value: 1
        episode:
          value: 100
        content_type:
          value: tv_show
        search_text:
          value: 'lost'
        action:
          value: 'find'

    bass:
      blocks:
        - type: 'attention'
          attention_type: 'no_such_episode'

    text: '{no_such_episode}'


test_authorize:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'description'

  dialog:
    авторизоваться:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.authorize_video_provider'
        slots:
          season:
            value: null
          provider:
            value: null

      bass:
        blocks:
          - type: 'attention'
            attention_type: 'video_sent_auth_push'

      text: '{video_sent_auth_push}'

    войти:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.authorize_video_provider'
        slots:
          season:
            value: null
          provider:
            value: null

      bass:
        blocks:
          - type: 'attention'
            attention_type: 'video_failed_to_send_auth_push'

      text: '{failed_to_send_push}'


test_payment_confirmed:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'description'

  dialog:
    купить:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.payment_confirmed'
        slots:
          season:
            value: null
          provider:
            value: null

      bass:
        blocks:
          - type: 'attention'
            attention_type: 'sent_buy_video_push'

      text: '{payment_confirmed}'

    купить 2 сезон:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.payment_confirmed'
        slots:
          season:
            value: 2
          provider:
            value: null

      bass:
        blocks:
          - type: 'attention'
            attention_type: 'sent_buy_video_push'

      text: '{payment_confirmed}'

    купить!:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.payment_confirmed'

      bass:
        blocks:
          - type: 'attention'
            attention_type: 'video_failed_to_send_push'

      text: '{failed_to_send_push}'


test_season_gallery_payment_confirmed:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'season_gallery'

  dialog:
    купить:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.payment_confirmed'

      bass:
        blocks:
          - type: 'attention'
            attention_type: 'sent_buy_video_push'

      text: '{payment_confirmed}'


test_payment_confirmed_dont_need_to_buy:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'description'

  dialog:
    купить:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.payment_confirmed'

      bass:
        blocks:
          - type: 'attention'
            attention_type: 'video_already_available'

      text: '{payment_confirmed_dont_need_to_buy}'


test_payment_confirmed_on_ivi:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'description'

  dialog:
    купить на иви:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.payment_confirmed'
        slots:
          content_provider:
            value: 'ivi'

      bass:
        blocks:
          - type: 'attention'
            attention_type: 'sent_buy_video_push'

      text: '{payment_confirmed}'


test_payment_confirmed_no_such_season:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'description'

  dialog:
    купить 20 сезон:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.payment_confirmed'
        slots:
          season:
            value: 20
          provider:
            value: null

      bass:
        blocks:
          - type: 'attention'
            attention_type: 'no_such_season'

      text: '{no_such_season}'


test_open_current_video:
  flags:
    xfail:
      value: true
      reason: 'Video intents in VINS are turned off, https://st.yandex-team.ru/MEGAMIND-385#5dd800f94b92d70cc178c24a'
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'description'

  dialog:
    запусти:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          action:
            value: 'play'

      bass:
        blocks:
          - type: 'attention'
            attention_type: 'video_autoplay'

      text: '{video_autoplay}'

    алиса включи:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          action:
            value: 'play'

    запусти на медиатеке:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          action:
            value: 'play'
          video_provider:
            value: amediateka

    на ютубе покажи пожалуйста:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          action:
            value: 'play'
          video_provider:
            value: youtube

    включи на кинопоиске:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          action:
            value: 'play'
          video_provider:
            value: kinopoisk


test_cannot_play_current_video_because_its_paid:
  flags:
    xfail:
      value: true
      reason: 'Video intents in VINS are turned off, https://st.yandex-team.ru/MEGAMIND-385#5dd800f94b92d70cc178c24a'
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'description'

  dialog:
    запусти:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          action:
            value: 'play'

      bass:
        blocks:
          - type: 'attention'
            attention_type: 'video_cannot_autoplay_because_its_paid'

      text: '{paid_content}'


test_autoplay_paid_video:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'main'

  dialog:
    включи фильм монстро:
      vins_form:
        name: 'personal_assistant.scenarios.video_play'

      bass:
        blocks:
          - type: 'attention'
            attention_type: 'video_cannot_autoplay_because_its_paid'

      text: '{paid_content}'

test_autoplay_not_authorized:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'main'

  dialog:
    включи фильм терминатор:
      vins_form:
        name: 'personal_assistant.scenarios.video_play'

      bass:
        blocks:
          - type: 'attention'
            attention_type: 'video_non_authorized_user'

      text: '{non_authorized}'


test_open_description_automatically:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'main'

  dialog:
    найди фильм монстро:
      vins_form:
        name: 'personal_assistant.scenarios.video_play'

      bass:
        blocks:
          - type: 'attention'
            attention_type: 'video_autoselect'

      text: '{show_description}'


test_open_current_video_episode_season:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'description'

  dialog:
    включить пятую серию последнего сезона:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          action:
            value: 'play'
          episode:
            value: 5
          season:
            value: 'last'

      bass:
        blocks:
          - type: 'attention'
            attention_type: 'video_autoplay'

      text: '{video_autoplay}'

    сезон номер 1 серия 2:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          action:
            value: null
          episode:
            value: 2
          season:
            value: 1

      text: '{show_description}'

    покажи описание 3 серии:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          action:
            value: 'description'
          episode:
            value: 3
          season:
            value: null

      text: '{show_description}'

    включи последнюю серию предыдущего сезона:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          action:
            value: 'play'
          episode:
            value: 'last'
          season:
            value: 'prev'

      bass:
        blocks:
          - type: 'attention'
            attention_type: 'video_autoplay'

      text: '{video_autoplay}'

    покажи следующий сезон:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          action:
            value: play
          episode:
            value: null
          season:
            value: 'next'
      text: '{show_description}'

    второй сезон на яндекс видео:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          action:
            value: null
          season:
            value: 2
          video_provider:
            value: yavideo


test_open_current_video_from_payment:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'payment'

  dialog:
    включить пятую серию последнего сезона:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          action:
            value: 'play'
          episode:
            value: 5
          season:
            value: 'last'

      bass:
        blocks:
          - type: 'attention'
            attention_type: 'video_autoplay'

      text: '{video_autoplay}'


test_open_current_video_from_player:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'video_player'

  dialog:
    покажи описание последней серии:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          action:
            value: 'description'
          episode:
            value: 'last'
          season:
            value: null

      text: '{show_description}'


test_open_episode_from_season_gallery:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'season_gallery'

  dialog:
    включи 3 серию:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          action:
            value: 'play'
          episode:
            value: 3
          season:
            value: null

      bass:
        blocks:
          - type: 'attention'
            attention_type: 'video_autoplay'

      text: '{video_autoplay}'

test_next_season_from_season_gallery:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'season_gallery'
      screen_state:
        items:
          - name: 'Сезон 1 Серия 1'
          - name: 'Сезон 1 Серия 2'
        visible_items: [0, 1]
  dialog:
    следующий сезон:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          action:
            value: null
          episode:
            value: null
          season:
            value: 'next'
      text: '{show_description}'


test_search_movie_from_description_screen:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'description'

  dialog:
    включи фильм жестокие игры:
      vins_form:
        name: 'personal_assistant.scenarios.video_play'


test_westworld_autoplay:
  flags:
    skip:
      value: true
      reason: 'There is no vins.video scenario'
  включи мир дикого запада:
    vins_form:
      name: 'personal_assistant.scenarios.video_play'
      slots:
        action:
          value: 'play'
        search_text:
          value: 'мир дикого запада'

    bass:
      blocks:
        - type: 'attention'
          attention_type: 'video_autoplay'
        - type: 'attention'
          attention_type: 'playing_westworld_tv_show'
        - type: 'command'
          command_type: 'video_play'

    text: '{video_autoplay}{westworld_play}'


test_select_from_gallery_without_visible_items:
  experiments:  ['quasar_video_dont_use_visible_items']

  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'gallery'
      screen_state:
        items:
          - provider_name: 'ivi'
            provider_item_id: '31337'
            type: 'movie'
            name: 'Классное: Видео! а'
          - provider_name: 'ivi'
            provider_item_id: '32167'
            type: 'movie'
            name: 'Отстойное, Видео? у'
          - provider_name: 'ivi'
            provider_item_id: '77777'
            type: 'movie'
            name: 'титаник'
        visible_items: [0, 1]

  dialog:
    включи фильм титаник:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'
        slots:
          action:
            value: 'play'
          video_index:
            value: 3

      bass:
        blocks:
          - type: 'attention'
            attention_type: 'video_autoplay'

      text: '{video_autoplay}'


test_select_from_gallery:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'gallery'
      screen_state:
        items:
          - provider_name: 'ivi'
            provider_item_id: '31337'
            type: 'movie'
            name: 'Классное: Видео! а'
          - provider_name: 'ivi'
            provider_item_id: '32167'
            type: 'movie'
            name: 'Отстойное, Видео? у'
          - provider_name: 'ivi'
            provider_item_id: '77777'
            type: 'movie'
            name: 'титаник'
        visible_items: [0, 1]

  dialog:
    включи фильм титаник:
      vins_form:
        name: 'personal_assistant.scenarios.video_play'

    включи номер 3:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'
        slots:
          action:
            value: 'play'
          video_index:
            value: 3

    включи номер 1:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'
        slots:
          action:
            value: 'play'
          video_index:
            value: 1

      bass:
        blocks:
          - type: 'attention'
            attention_type: 'video_autoplay'

      text: '{video_autoplay}'

    номер 2:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'
        slots:
          action:
            value: null
          video_index:
            value: 2

      bass:
        blocks:
          - type: 'attention'
            attention_type: 'video_autoplay'

      text: '{video_autoplay}'

    '1':
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'
        slots:
          action:
            value: null
          video_index:
            value: 1

      text: '{show_description}'

    описание номер 2:
      vins_form:
        slots:
          action:
            value: 'description'
          video_index:
            value: 2

      text: '{show_description}'

    давай классное:
      vins_form:
        slots:
          action:
            value: null
          video_index:
            value: 1

      text: '{show_description}'

    классное видео:
      vins_form:
        slots:
          action:
            value: null
          video_index:
            value: 1

      text: '{show_description}'

    отстойное видео:
      vins_form:
        slots:
          action:
            value: null
          video_index:
            value: 2

      text: '{show_description}'

    включи отстойное видео:
      vins_form:
        slots:
          action:
            value: 'play'
          video_index:
            value: 2

      bass:
        blocks:
          - type: 'attention'
            attention_type: 'video_autoplay'

      text: '{video_autoplay}'

    а включи 2:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'
        slots:
          action:
            value: 'play'
          video_index:
            value: 2

      bass:
        blocks:
          - type: 'attention'
            attention_type: 'video_cannot_autoplay_because_its_paid'

      text: '{paid_content}'

    поставь первое видео на иви:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'
        slots:
          action:
            value: 'play'
          video_index:
            value: 1
          video_provider:
            value: ivi

    запусти на медиатеке отстойное:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'
        slots:
          action:
            value: 'play'
          video_index:
            value: 2
          video_provider:
            value: amediateka

    номер два на кинопоиске пожалуйста:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'
        slots:
          video_index:
            value: 2
          video_provider:
            value: kinopoisk





test_select_from_season_gallery:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'season_gallery'
      screen_state:
        items:
          - provider_name: 'ivi'
            provider_item_id: '31337'
            type: 'movie'
            name: 'Классное: Видео! а'
          - provider_name: 'ivi'
            provider_item_id: '32167'
            type: 'movie'
            name: 'Отстойное, Видео? у'
          - provider_name: 'ivi'
            provider_item_id: '77777'
            type: 'movie'
            name: 'титаник'
        visible_items: [0, 1]

  dialog:
    номер 2:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'
        slots:
          action:
            value: null
          video_index:
            value: 2

      bass:
        blocks:
          - type: 'attention'
            attention_type: 'video_autoplay'

      text: '{video_autoplay}'

    '1':
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'
        slots:
          action:
            value: null
          video_index:
            value: 1

      text: '{show_description}'

    а включи 2:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'
        slots:
          action:
            value: 'play'
          video_index:
            value: 2

      bass:
        blocks:
          - type: 'attention'
            attention_type: 'video_cannot_autoplay_because_its_paid'

      text: '{paid_content}'

    2 сезон:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          season:
            value: 2

    1 серия:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          episode:
            value: 1

    давай классное:
      vins_form:
        slots:
          action:
            value: null
          video_index:
            value: 1

      text: '{show_description}'


test_video_selection_with_small_overlap:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'gallery'
      screen_state:
        items:
          - name: 'Беглец'
          - name: 'Беглец'
          - name: 'Беглецы'
          - name: 'Поезд-беглец'
          - name: 'Охотник за головами'
        visible_items: [0, 1, 2, 3, 4]

  dialog:
    беглец:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'
        slots:
          action:
            value: null
          video_index:
            value: 1

    включи фильм беглецы:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'
        slots:
          action:
            value: 'play'
          video_index:
            value: 3

    поезд беглец:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'
        slots:
          action:
            value: null
          video_index:
            value: 4

    давай номер 2:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'
        slots:
          action:
            value: null
          video_index:
            value: 2

    '5':
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'
        slots:
          action:
            value: null
          video_index:
            value: 5

    найди фильм терминатор 2:
      vins_form:
        name: 'personal_assistant.scenarios.video_play'

    терминатор 3:
      vins_form:
        name: 'personal_assistant.scenarios.video_play'

    игра престолов 3 сезон:
      vins_form:
        name: 'personal_assistant.scenarios.video_play'


test_video_selection_many_similar_options:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'season_gallery'
      screen_state:
        items:
          - name: 'Игра престолов'
          - name: 'Игра Престолов. В ожидании нового сезона'
          - name: 'Игра Престолов. Один День из Жизни'
          - name: 'Секреты Игры Престолов'
          - name: 'Игра'
        visible_items: [0, 1, 2, 3, 4]

  dialog:
    включи игру престолов:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'
        slots:
          action:
            value: 'play'
          video_index:
            value: 1

    включи игра престолов:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'
        slots:
          action:
            value: 'play'
          video_index:
            value: 1

    включи в ожидании нового сезона:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'
        slots:
          action:
            value: 'play'
          video_index:
            value: 2

    включи игра престолов в ожидании нового:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'
        slots:
          action:
            value: 'play'
          video_index:
            value: 2

    игра престолов день из жизни:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'
        slots:
          action:
            value: null
          video_index:
            value: 3

    включи игру:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'
        slots:
          action:
            value: 'play'
          video_index:
            value: 5


test_video_continue:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'main'
  dialog:
    продолжим смотреть терминатор:
      vins_form:
        name: 'personal_assistant.scenarios.video_play'
        slots:
          action:
            value: continue
          search_text:
            value: терминатор

    давай продолжим смотреть 5 сезон игры престолов:
      vins_form:
        name: 'personal_assistant.scenarios.video_play'
        slots:
          action:
            value: continue
          season:
            value: 5
          search_text:
            value: игры престолов


test_show_season_gallery_from_description:
  flags:
    skip:
      value: true
      reason: 'There is no vins.video scenario'
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'description'
  dialog:
    2 сезон:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          season:
            value: 2
      bass:
        blocks:
          - type: command
            command_type: show_season_gallery
            command_sub_type: video_show_season_gallery
          - type: attention
            attention_type: video_season_gallery
      text: '{show_season_gallery}'
      voice: '{show_season_gallery}'


test_show_fresh_season:
  flags:
    skip:
      value: true
      reason: 'There is no vins.video scenario'
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'description'
  dialog:
    свежий сезон:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          season:
            value: last
      bass:
        blocks:
          - type: command
            command_type: show_season_gallery
            command_sub_type: video_show_season_gallery
          - type: attention
            attention_type: video_season_gallery
      text: '{show_season_gallery}'
      voice: '{show_season_gallery}'

test_show_all_seasons:
  flags:
    xfail:
      value: true
      reason: 'this test might be flapping, because there are 2 alternative forms and bass currently accepts only one'
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'description'
  dialog:
    открой все сезоны:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          action:
            value: list_seasons
        # this test might be flapping. An alternative allowable form is the following:
        #  season:
        #    value: all
      voice: '{video_autoplay}'


test_no_relevant_video:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'main'
  dialog:
    включи терминатор против рембо 2:
      vins_form:
        name: 'personal_assistant.scenarios.video_play'
      bass:
        blocks:
          - type: 'attention'
            attention_type: 'video_gallery'
          - type: 'attention'
            attention_type: 'video_no_good_result'
      text: '{no_relevant_video}'


test_provider_filtered:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'main'
  dialog:
    фильмы на амедиатеке:
      vins_form:
        name: 'personal_assistant.scenarios.video_play'
        slots:
          content_type:
            value: 'movie'
          content_provider:
            value: 'amediateka'
      bass:
        blocks:
          - type: 'attention'
            attention_type: 'provider_is_forbidden_for_family_search'
      text: '{provider_is_forbidden_for_family_search}'


test_content_filtered:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'main'
  dialog:
    включи порнуху:
      vins_form:
        name: 'personal_assistant.scenarios.video_play'
        slots:
          film_genre:
            value: 'porno'
      bass:
        blocks:
          - type: 'attention'
            attention_type: 'all_results_filtered'
      text: '{all_results_filtered}'


test_context_in_video_gallery:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'season_gallery'
      screen_state:
        items:
          - name: 'Игра престолов'
          - name: 'Игра Престолов. В ожидании нового сезона'
          - name: 'Игра Престолов. Один День из Жизни'
          - name: 'Секреты Игры Престолов'
          - name: 'Игра'
        visible_items: [0, 1, 2, 3, 4]

  bass:
    form:
      result:
        value: 1337

  dialog:
    загадай число:
      text: '{leet}'

    еще число:
      text: '{leet}'


test_quasar_without_tv:
  flags:
    xfail:
      value: true
      reason: 'This feature is currently turned off because of side effects'
  app_info:
    app_id: 'ru.yandex.quasar.vins_test'
    app_version: '1.0'
    os_version: '6.0.1'
    platform: 'android'

  device_state:
    is_tv_plugged_in: false

  dialog:
    включи игру престолов первую серию нового сезона:
      vins_form:
        name: 'personal_assistant.scenarios.video_play'
      text: '{please_connect_tv}'

test_youtube_does_open_on_quasar:
  app_info:
    app_id: 'ru.yandex.quasar.vins_test'
    app_version: '1.0'
    os_version: '6.0.1'
    platform: 'android'
  device_state:
    is_tv_plugged_in: true

  dialog:
    открой мне youtube:
      vins_form:
        name: 'personal_assistant.scenarios.video_play'
        slots:
          content_provider:
            value: youtube
    покажи иви:
      vins_form:
        name: 'personal_assistant.scenarios.video_play'
        slots:
          content_provider:
            value: ivi

test_youtube_does_not_open_on_quasar_without_tv:
  app_info:
    app_id: 'ru.yandex.quasar.vins_test'
    app_version: '1.0'
    os_version: '6.0.1'
    platform: 'android'
  device_state:
    is_tv_plugged_in: false
  dialog:
    открой мне youtube:
      vins_form:
        name: 'personal_assistant.scenarios.open_site_or_app'
      bass_form:
        blocks:
          - type: 'attention'
            attention_type: 'nav_not_supported_on_device'
    покажи иви:
      vins_form:
        name: 'personal_assistant.scenarios.open_site_or_app'
      bass_form:
        blocks:
          - type: 'attention'
            attention_type: 'nav_not_supported_on_device'

test_video_aliced:
  app_info:
    app_id: 'aliced.vins_test'
    app_version: '1.2.3'
    os_version: '0'
    device_manufacturer: 'Irbis'
    platform: 'linux'
  device_state:
    is_tv_plugged_in: false
  dialog:
    Включи последнюю серию Мира Дикого Запада:
      vins_form:
        name: personal_assistant.scenarios.video_play


test_youtube_does_not_open_on_mobile:
  app_info:
    app_id: 'ru.yandex.mobile'
    app_version: '0'
    os_version: '0'
    platform: 'iphone'
  device_state:
    is_tv_plugged_in: false

  dialog:
    открой мне youtube:
      vins_form:
        name: 'personal_assistant.scenarios.open_site_or_app'
        slots:
          target:
            value: youtube
    покажи иви:
      vins_form:
        name: 'personal_assistant.scenarios.open_site_or_app'
        slots:
          target:
            value: иви

test_play_as_continue_1:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'video_player'
  dialog:
    играй:
      vins_form:
        name: 'personal_assistant.scenarios.player_continue'

test_play_as_continue_2:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'main'
  dialog:
    играй:
      vins_form:
        name: 'personal_assistant.scenarios.player_continue'

test_play_as_open_current_video:
  flags:
    xfail:
      value: true
      reason: 'Video intents in VINS are turned off, https://st.yandex-team.ru/MEGAMIND-385#5dd800f94b92d70cc178c24a'
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'description'
  dialog:
    играй:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          action:
            value: 'play'

test_what_to_watch_online:
  что посмотреть в сети:
    vins_form:
      name: 'personal_assistant.scenarios.video_play'

test_continue_payment:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'description'
  dialog:
    продолжить оплату:
      vins_form:
        name: personal_assistant.scenarios.quasar.payment_confirmed

test_house_md:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'main'
  dialog:
    доктор хаус:
      vins_form:
        name: personal_assistant.scenarios.video_play
      text: '{show_gallery}'

test_new_request_instead_of_payment:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'description'
  dialog:
    2 серия 1 сезона миллиарды:
      vins_form:
        name: personal_assistant.scenarios.video_play

video_request_in_music_context_in_quasar:
  flags:
    xfail:
      value: true
      reason: "Classifier's scores are unstable, video_play/music_play confidences are almost equal"
  experiments: [quasar_music_boost]
  app_info:
    app_id: 'ru.yandex.quasar.vins_test'
    app_version: '1.0'
    os_version: '6.0.1'
    platform: 'android'
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'music_player'
  dialog:
    поставь inception:
      vins_form:
        name: 'personal_assistant.scenarios.video_play'

test_ambiguous_requests:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'main'
  dialog:
    включи сериал:
      vins_form:
        name: personal_assistant.scenarios.video_play
    включи фильм:
      vins_form:
        name: personal_assistant.scenarios.video_play
    смотреть фильм:
      vins_form:
        name: personal_assistant.scenarios.video_play
    запусти фильм:
      vins_form:
        name: personal_assistant.scenarios.video_play
    давай что-нибудь посмотрим:
      vins_form:
        name: personal_assistant.scenarios.video_play

test_prev_episode:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'description'
  dialog:
    запусти последнюю серию:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          action:
            value: 'play'
          episode:
            value: 'last'
    давай последнюю серию:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          episode:
            value: 'last'
    вруби последнюю серию:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          action:
            value: 'play'
          episode:
            value: 'last'
    включи последнюю серию:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
        slots:
          action:
            value: 'play'
          episode:
            value: 'last'

test_youtube_DIALOG-3049:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'main'
  dialog:
    выйди в ютуб:
      vins_form:
        name: personal_assistant.scenarios.video_play
    ютуб:
      vins_form:
        name: personal_assistant.scenarios.video_play
    давай посмотрим ютуб:
      vins_form:
        name: personal_assistant.scenarios.video_play
    запусти ютуб:
      vins_form:
        name: personal_assistant.scenarios.video_play

test_attentions_for_open_current_video:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'description'
  attention_video_autoselect:
    включи первую серию:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
      bass:
        blocks:
        - type: attention
          attention_type: video_autoselect
      text: '{show_description}'
  attention_sent_buy_video_push:
    включи первую серию:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
      bass:
        blocks:
        - type: attention
          attention_type: sent_buy_video_push
      text: '{video_payment_push}'
  attention_video_failed_to_send_push:
    включи первую серию:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
      bass:
        blocks:
        - type: attention
          attention_type: video_failed_to_send_push
      text: '{failed_to_send_push}'

test_attentions_for_select_video_from_gallery:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'description'
      screen_state:
        items:
          - provider_name: 'ivi'
            provider_item_id: '31337'
            type: 'movie'
            name: 'Классный фильм'
  attention_no_such_season:
    включи третий эпизод:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
      bass:
        blocks:
        - type: attention
          attention_type: no_such_season
      text: '{no_such_season}'
  attention_no_such_episode:
    включи тринадцатый сезон:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
      bass:
        blocks:
        - type: attention
          attention_type: no_such_episode
      text: '{no_such_episode}'
  attention_sent_buy_video_push:
    включи третий эпизод:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
      bass:
        blocks:
        - type: attention
          attention_type: sent_buy_video_push
      text: '{video_payment_push}'
  attention_video_failed_to_send_push:
    включи третий эпизод:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
      bass:
        blocks:
        - type: attention
          attention_type: video_failed_to_send_push
      text: '{failed_to_send_push}'
  video_non_authorized_user:
    включи третий эпизод:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
      bass:
        blocks:
        - type: attention
          attention_type: video_non_authorized_user
      text: '{non_authorized}'

test_attentions_for_video_play:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'description'
  attention_sent_buy_video_push:
    начать просмотр на кинопоиске:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
      bass:
        blocks:
        - type: attention
          attention_type: sent_buy_video_push
      text: '{video_payment_push}'
  attention_video_failed_to_send_push:
    начать просмотр на кинопоиске:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.open_current_video'
      bass:
        blocks:
        - type: attention
          attention_type: video_failed_to_send_push
      text: '{failed_to_send_push}'

test_commands_on_gallery:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'gallery'
      screen_state:
        items:
          - provider_name: 'ivi'
            provider_item_id: '31337'
            type: 'movie'
            name: 'Путь домой'
          - provider_name: 'ivi'
            provider_item_id: '32167'
            type: 'movie'
            name: 'Прибавьте громкость'
          - provider_name: 'ivi'
            provider_item_id: '77777'
            type: 'movie'
            name: 'Первая помощь'
        visible_items: [0, 1, 2]
    sound_level: 5
  go_home:
    домой:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.go_home'
    включи путь домой:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'
  sound_louder:
    прибавь громкость:
      vins_form:
        name: 'personal_assistant.scenarios.sound_louder'
    поставь фильм прибавьте громкость:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'
  onboarding:
    помощь:
      vins_form:
        name: 'personal_assistant.scenarios.onboarding'
    первая помощь:
      vins_form:
        name: 'personal_assistant.scenarios.quasar.select_video_from_gallery'

test_purchase_not_found:
  включи 10 серию 20 сезона сериала друзья:
    vins_form:
      name: 'personal_assistant.scenarios.video_play'
      slots:
        season:
          value: 20
        episode:
          value: 10
        content_type:
          value: tv_show
        search_text:
          value: 'друзья'
        action:
          value: 'play'

    bass:
      blocks:
        - type: 'attention'
          attention_type: 'video_error_purchase_not_found'

    text: '{video_error_purchase_not_found}'

test_purchase_expired:
  включи 10 серию 20 сезона сериала друзья:
    vins_form:
      name: 'personal_assistant.scenarios.video_play'
      slots:
        season:
          value: 20
        episode:
          value: 10
        content_type:
          value: tv_show
        search_text:
          value: 'друзья'
        action:
          value: 'play'

    bass:
      blocks:
        - type: 'attention'
          attention_type: 'video_error_purchase_expired'

    text: '{video_error_purchase_expired}'

test_video_error_service_constraint_violation:
  включи 10 серию 20 сезона сериала друзья:
    vins_form:
      name: 'personal_assistant.scenarios.video_play'
      slots:
        season:
          value: 20
        episode:
          value: 10
        content_type:
          value: tv_show
        search_text:
          value: 'друзья'
        action:
          value: 'play'

    bass:
      blocks:
        - type: 'attention'
          attention_type: 'video_error_service_constraint_violation'

    text: '{video_error_service_constraint_violation}'

test_video_error_subscription_not_found:
  включи 10 серию 20 сезона сериала друзья:
    vins_form:
      name: 'personal_assistant.scenarios.video_play'
    bass:
      blocks:
        - type: 'attention'
          attention_type: 'video_error_subscription_not_found'
    text: '{video_error_subscription_not_found}'

test_video_error_geo_constraint_violation:
  включи 10 серию 20 сезона сериала друзья:
    vins_form:
      name: 'personal_assistant.scenarios.video_play'
    bass:
      blocks:
        - type: 'attention'
          attention_type: 'video_error_geo_constraint_violation'
    text: '{video_error_geo_constraint_violation}'

test_video_error_licenses_not_found:
  включи 10 серию 20 сезона сериала друзья:
    vins_form:
      name: 'personal_assistant.scenarios.video_play'
    bass:
      blocks:
        - type: 'attention'
          attention_type: 'video_error_licenses_not_found'
    text: '{video_error_licenses_not_found}'

test_video_error_supported_streams_not_found:
  включи 10 серию 20 сезона сериала друзья:
    vins_form:
      name: 'personal_assistant.scenarios.video_play'
    bass:
      blocks:
        - type: 'attention'
          attention_type: 'video_error_supported_streams_not_found'
    text: '{video_error_supported_streams_not_found}'

video_without_screen_in_quasar:
  app_info:
    app_id: 'ru.yandex.quasar.vins_test'
    app_version: '1.0'
    os_version: '6.0.1'
    platform: 'android'
  device_state:
    is_tv_plugged_in: false
    music:
      currently_playing:
        track_id: 'some_song'
      player:
        pause: false
  case1:
    включи сериал игра престолов:
      vins_form:
        name: personal_assistant.scenarios.video_play
  case2:
    включи мультики:
      vins_form:
        name: personal_assistant.scenarios.video_play
  case3:
    включи щенячий патруль:
      vins_form:
        name: personal_assistant.scenarios.video_play
  case4:
    Включи последнюю серию Мира Дикого Запада:
      vins_form:
        name: personal_assistant.scenarios.video_play
  case5:
    Найди фильмы на Кинопоиске:
      vins_form:
        name: personal_assistant.scenarios.video_play

video_without_screen_in_aliced_explicit:
  app_info:
    app_id: 'aliced'
    app_version: '1.0'
    os_version: '6.0.1'
    platform: 'android'
  device_state:
    is_tv_plugged_in: false
    music:
      currently_playing:
        track_id: 'some_song'
      player:
        pause: false
  test:
    включи мультики:
      vins_form:
        name: personal_assistant.scenarios.video_play

video_without_screen_in_aliced_implicit:
  app_info:
    app_id: 'aliced'
    app_version: '1.0'
    os_version: '6.0.1'
    platform: 'android'
  device_state:
    music:
      currently_playing:
        track_id: 'some_song'
      player:
        pause: false
  test:
    включи мультики:
      vins_form:
        name: personal_assistant.scenarios.video_play

test_mordovia_item_selector:
  device_state:
    is_tv_plugged_in: true
    video:
      current_screen: 'mordovia_webview'
      view_state:
        sections:
          - type: video
            active: True
            title: 'Классное: Видео! а'
            number: 1
            metaforback:
              uuid: 1234
              streams: 1234
              url: video1
          - type: video
            active: True
            title: 'Отстойное, Видео? у'
            number: 2
            metaforback:
              uuid: 1234
              streams: 1234
              url: video2
  experiments:
    mordovia: True
    forbidden_intents: 'personal_assistant.scenarios.quasar.select_video_from_gallery_by_text'
  dialog:
    включи номер 2:
      vins_form:
        name: 'personal_assistant.scenarios.ether.quasar.video_select'
        slots:
          content_url:
            value: 'video2'
      text: 'Ничего не нашлось.'  # testing_framework.py works in such a way that without text field, the slots do not get validated
