{
    "default_kwargs": {
        "date": "2021-04-07"
    },
    "default_sources": {
        "activations": {}
    },
    "tests": [
        {
            "test_name": "test_simple",
            "kwargs": {
                "date": "2021-04-07"
            },
            "sources": {
                "input": [
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:30",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:01:00",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_opened",
                        "event_value": {
                            "device_name": "PS 5",
                            "hdmi_session_id": "2"
                        },
                        "event_datetime": "2021-04-07 00:01:30",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "2"
                        },
                        "event_datetime": "2021-04-07 00:02:00",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "2"
                        },
                        "event_datetime": "2021-04-07 00:02:30",
                        "device_id": 2
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "hdmi_timespent": [
                            [
                                "PS 5",
                                "no_port",
                                30
                            ],
                            [
                                "undefined_device",
                                "undefined_port",
                                60
                            ]
                        ],
                        "device_id": 1
                    },
                    {
                        "hdmi_timespent": [
                            [
                                "undefined_device",
                                "undefined_port",
                                30
                            ]
                        ],
                        "device_id": 2
                    }
                ]
            }
        },
        {
            "test_name": "test_day_boundary",
            "kwargs": {
                "date": "2021-04-07"
            },
            "sources": {
                "input": [
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:05",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_session_info",
                        "event_value": {
                            "time_spent": 60,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:40",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_session_info",
                        "event_value": {
                            "time_spent": 60,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:45",
                        "device_id": 2
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "hdmi_timespent": [
                            [
                                "undefined_device",
                                "undefined_port",
                                40
                            ]
                        ],
                        "device_id": 1
                    },
                    {
                        "hdmi_timespent": [
                            [
                                "undefined_device",
                                "undefined_port",
                                45
                            ]
                        ],
                        "device_id": 2
                    }
                ]
            }
        },
        {
            "test_name": "test_heartbeat_ddos",
            "kwargs": {
                "date": "2021-04-07"
            },
            "sources": {
                "input": [
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:05",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:05",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:05",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:05",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:06",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:07",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:08",
                        "device_id": 1
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "hdmi_timespent": [
                            [
                                "undefined_device",
                                "undefined_port",
                                33
                            ]
                        ],
                        "device_id": 1
                    }
                ]
            }
        },
        {
            "test_name": "test_ideal",
            "kwargs": {
                "date": "2021-04-07"
            },
            "sources": {
                "input": [
                    {
                        "event_name": "hdmi_opened",
                        "event_value": {
                            "device_name": "PS5",
                            "port": "HDMI 2",
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 11:00:00",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "hdmi_session_id": "1",
                            "period": 30
                        },
                        "event_datetime": "2021-04-07 11:00:30",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "hdmi_session_id": "1",
                            "period": 30
                        },
                        "event_datetime": "2021-04-07 11:01:00",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_session_info",
                        "event_value": {
                            "time_spent": 63,
                            "device_name": "PS5",
                            "session_port": "HDMI 2",
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 11:01:03",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_opened",
                        "event_value": {
                            "device_name": "Yandex station",
                            "port": "HDMI 1",
                            "hdmi_session_id": "2"
                        },
                        "event_datetime": "2021-04-07 00:02:00",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "hdmi_session_id": "2",
                            "period": 30
                        },
                        "event_datetime": "2021-04-07 11:02:30",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_session_info",
                        "event_value": {
                            "time_spent": 35,
                            "hdmi_session_id": "2"
                        },
                        "event_datetime": "2021-04-07 11:02:35",
                        "device_id": 1
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "hdmi_timespent": [
                            [
                                "PS5",
                                "HDMI 2",
                                63
                            ],
                            [
                                "Yandex station",
                                "HDMI 1",
                                35
                            ]
                        ],
                        "device_id": 1
                    }
                ]
            }
        },
        {
            "test_name": "test_no_device_and_unknown",
            "kwargs": {
                "date": "2021-04-07"
            },
            "sources": {
                "input": [
                    {
                        "event_name": "hdmi_opened",
                        "event_value": {
                            "device_name": "no_device",
                            "port": "HDMI 2",
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 11:00:00",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 11:00:30",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 11:01:00",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_session_info",
                        "event_value": {
                            "time_spent": 63,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 11:01:03",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_opened",
                        "event_value": {
                            "device_name": "unknown_device",
                            "port": "HDMI 1",
                            "hdmi_session_id": "2"
                        },
                        "event_datetime": "2021-04-07 11:02:00",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "2"
                        },
                        "event_datetime": "2021-04-07 11:02:30",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_session_info",
                        "event_value": {
                            "time_spent": 35,
                            "hdmi_session_id": "2"
                        },
                        "event_datetime": "2021-04-07 11:02:35",
                        "device_id": 1
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "hdmi_timespent": [
                            [
                                "no_device",
                                "HDMI 2",
                                63
                            ],
                            [
                                "unknown_device",
                                "HDMI 1",
                                35
                            ]
                        ],
                        "device_id": 1
                    }
                ]
            }
        },
        {
            "test_name": "test_no_device_and_unknown",
            "kwargs": {
                "date": "2021-04-07"
            },
            "sources": {
                "input": [
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 11:00:30",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_session_info",
                        "event_value": {
                            "time_spent": -35,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 11:02:35",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_session_info",
                        "event_value": {
                            "time_spent": -35,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 11:02:35",
                        "device_id": 2
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "hdmi_timespent": [
                            [
                                "undefined_device",
                                "undefined_port",
                                30
                            ]
                        ],
                        "device_id": 1
                    },
                    {
                        "hdmi_timespent": [
                            [
                                "undefined_device",
                                "undefined_port",
                                0
                            ]
                        ],
                        "device_id": 2
                    }
                ]
            }
        },
        {
            "test_name": "test_several_sessions",
            "kwargs": {
                "date": "2021-04-07"
            },
            "sources": {
                "input": [
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:30",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_session_info",
                        "event_value": {
                            "time_spent": 40,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:40",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "2"
                        },
                        "event_datetime": "2021-04-07 00:01:10",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_session_info",
                        "event_value": {
                            "time_spent": 35,
                            "hdmi_session_id": "2"
                        },
                        "event_datetime": "2021-04-07 00:01:45",
                        "device_id": 1
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "hdmi_timespent": [
                            [
                                "undefined_device",
                                "undefined_port",
                                75
                            ]
                        ],
                        "device_id": 1
                    }
                ]
            }
        },
        {
            "test_name": "test_negative_timespent",
            "kwargs": {
                "date": "2021-04-07"
            },
            "sources": {
                "input": [
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:30",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_session_info",
                        "event_value": {
                            "time_spent": -40,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:40",
                        "device_id": 1
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "hdmi_timespent": [
                            [
                                "undefined_device",
                                "undefined_port",
                                30
                            ]
                        ],
                        "device_id": 1
                    }
                ]
            }
        },
        {
            "test_name": "test_undefined_session_id",
            "kwargs": {
                "date": "2021-04-07"
            },
            "sources": {
                "input": [
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30
                        },
                        "event_datetime": "2021-04-07 00:00:30",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_session_info",
                        "event_value": {
                            "time_spent": 50
                        },
                        "event_datetime": "2021-04-07 00:00:50",
                        "device_id": 1
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "hdmi_timespent": [
                            [
                                "undefined_device",
                                "undefined_port",
                                50
                            ]
                        ],
                        "device_id": 1
                    }
                ]
            }
        },
        {
            "test_name": "test_cards_info",
            "kwargs": {
                "date": "2021-04-07"
            },
            "sources": {
                "input": [
                    {
                        "event_name": "card_show",
                        "event_value": {
                            "place": "movie",
                            "x": 0,
                            "y": 0
                        },
                        "event_datetime": "2021-04-07 00:00:30"
                    },
                    {
                        "event_name": "card_show",
                        "event_value": {
                            "place": "movie",
                            "x": 1,
                            "y": 0
                        },
                        "event_datetime": "2021-04-07 00:00:31"
                    },
                    {
                        "event_name": "card_show",
                        "event_value": {
                            "place": "movie",
                            "x": 2,
                            "y": 0
                        },
                        "event_datetime": "2021-04-07 00:00:32"
                    },
                    {
                        "event_name": "card_click",
                        "event_value": {
                            "place": "main",
                            "x": 0,
                            "y": 0,
                            "carousel_name": "For you"
                        },
                        "event_datetime": "2021-04-07 00:00:30"
                    },
                    {
                        "event_name": "card_show",
                        "event_value": {
                            "place": "movie",
                            "x": 0,
                            "y": 0
                        },
                        "event_datetime": "2021-04-07 00:00:31"
                    },
                    {
                        "event_name": "screen_changed",
                        "event_value": {
                            "to": "movie"
                        },
                        "event_datetime": "2021-04-07 00:00:40"
                    },
                    {
                        "event_name": "card_show",
                        "event_value": {
                            "place": "movie",
                            "x": 1,
                            "y": 0
                        },
                        "event_datetime": "2021-04-07 00:00:50"
                    },
                    {
                        "event_name": "card_show",
                        "event_value": {
                            "place": "kids",
                            "x": 2,
                            "y": 0
                        },
                        "event_datetime": "2021-04-07 00:00:50"
                    },
                    {
                        "event_name": "screen_changed",
                        "event_value": {
                            "to": "movie"
                        },
                        "event_datetime": "2021-04-07 00:00:51"
                    },
                    {
                        "event_name": "card_show",
                        "event_value": {
                            "place": "blogger",
                            "x": 5,
                            "y": 0
                        },
                        "event_datetime": "2021-04-07 00:01:52"
                    },
                    {
                        "event_name": "card_click",
                        "event_value": {
                            "place": "blogger",
                            "x": -1,
                            "y": 0
                        },
                        "event_datetime": "2021-04-07 00:01:53"
                    },
                    {
                        "event_name": "card_click",
                        "event_value": {
                            "place": "blogger",
                            "y": 0
                        },
                        "event_datetime": "2021-04-07 00:01:53"
                    },
                    {
                        "event_name": "screen_changed",
                        "event_value": {
                            "to": "movie"
                        },
                        "event_datetime": "2021-04-07 00:00:51"
                    },
                    {
                        "event_name": "card_show",
                        "event_value": {
                            "place": "blogger"
                        },
                        "event_datetime": "2021-04-07 00:02:52"
                    },
                    {
                        "event_name": "card_show",
                        "event_value": {
                            "place": "blogger",
                            "y": 10
                        },
                        "event_datetime": "2021-04-07 00:02:52"
                    },
                    {
                        "event_name": "card_show",
                        "event_value": {
                            "place": "blogger",
                            "x": 2,
                            "y": 0
                        },
                        "event_datetime": "2021-04-07 00:02:52"
                    },
                    {
                        "event_name": "card_show",
                        "event_value": {
                            "place": "blogger",
                            "x": 3,
                            "y": 0
                        },
                        "event_datetime": "2021-04-07 00:02:52"
                    },
                    {
                        "event_name": "card_click",
                        "event_value": {
                            "place": "blogger",
                            "y": 0
                        },
                        "event_datetime": "2021-04-07 00:02:53"
                    },
                    {
                        "event_name": "card_click",
                        "event_value": {
                            "place": "show_more_items",
                            "y": 0
                        },
                        "event_datetime": "2021-04-07 00:02:53"
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "cards_info": [
                            [
                                "movie",
                                "undefined",
                                0,
                                0,
                                "show",
                                2
                            ],
                            [
                                "movie",
                                "undefined",
                                0,
                                1,
                                "show",
                                2
                            ],
                            [
                                "movie",
                                "undefined",
                                0,
                                2,
                                "show",
                                1
                            ],
                            [
                                "main",
                                "For you",
                                0,
                                0,
                                "click",
                                1
                            ],
                            [
                                "kids",
                                "undefined",
                                0,
                                2,
                                "show",
                                1
                            ],
                            [
                                "blogger",
                                "undefined",
                                0,
                                -1,
                                "click",
                                1
                            ],
                            [
                                "blogger",
                                "undefined",
                                0,
                                null,
                                "click",
                                2
                            ],
                            [
                                "blogger",
                                "undefined",
                                null,
                                null,
                                "show",
                                1
                            ],
                            [
                                "blogger",
                                "undefined",
                                10,
                                null,
                                "show",
                                1
                            ],
                            [
                                "blogger",
                                "undefined",
                                0,
                                5,
                                "show",
                                1
                            ],
                            [
                                "blogger",
                                "undefined",
                                0,
                                2,
                                "show",
                                1
                            ],
                            [
                                "blogger",
                                "undefined",
                                0,
                                3,
                                "show",
                                1
                            ]
                        ]
                    }
                ]
            }
        },
        {
            "test_name": "test_carousels_info",
            "kwargs": {
                "date": "2021-04-07"
            },
            "sources": {
                "input": [
                    {
                        "event_name": "card_click",
                        "event_value": {
                            "place": "main",
                            "carousel_name": "For you",
                            "x": 0
                        },
                        "event_datetime": "2021-04-07 00:00:30"
                    },
                    {
                        "event_name": "card_show",
                        "event_value": {
                            "place": "movie",
                            "carousel_name": "Recent",
                            "x": 0
                        },
                        "event_datetime": "2021-04-07 00:00:31"
                    },
                    {
                        "event_name": "screen_changed",
                        "event_value": {
                            "to": "movie"
                        },
                        "event_datetime": "2021-04-07 00:00:40"
                    },
                    {
                        "event_name": "card_show",
                        "event_value": {
                            "place": "movie",
                            "carousel_name": "For you",
                            "x": 1
                        },
                        "event_datetime": "2021-04-07 00:00:50"
                    },
                    {
                        "event_name": "card_show",
                        "event_value": {
                            "place": "kids",
                            "carousel_name": "For you",
                            "x": 2
                        },
                        "event_datetime": "2021-04-07 00:00:50"
                    },
                    {
                        "event_name": "screen_changed",
                        "event_value": {
                            "to": "movie"
                        },
                        "event_datetime": "2021-04-07 00:00:51"
                    },
                    {
                        "event_name": "card_show",
                        "event_value": {
                            "place": "blogger",
                            "carousel_name": "For you",
                            "x": 5
                        },
                        "event_datetime": "2021-04-07 00:01:52"
                    },
                    {
                        "event_name": "card_click",
                        "event_value": {
                            "place": "blogger",
                            "carousel_name": "For you",
                            "x": -1,
                            "y": 1
                        },
                        "event_datetime": "2021-04-07 00:01:53"
                    },
                    {
                        "event_name": "card_show",
                        "event_value": {
                            "place": "blogger",
                            "carousel_name": "Hits"
                        },
                        "event_datetime": "2021-04-07 00:01:54"
                    },
                    {
                        "event_name": "screen_changed",
                        "event_value": {
                            "to": "movie"
                        },
                        "event_datetime": "2021-04-07 00:01:56"
                    },
                    {
                        "event_name": "card_show",
                        "event_value": {
                            "place": "blogger",
                            "carousel_name": "Hits"
                        },
                        "event_datetime": "2021-04-07 00:02:52"
                    },
                    {
                        "event_name": "card_show",
                        "event_value": {
                            "place": "blogger",
                            "carousel_name": "Hits",
                            "x": 2
                        },
                        "event_datetime": "2021-04-07 00:02:52"
                    },
                    {
                        "event_name": "card_show",
                        "event_value": {
                            "place": "blogger",
                            "carousel_name": "Hits",
                            "x": 3
                        },
                        "event_datetime": "2021-04-07 00:02:52"
                    },
                    {
                        "event_name": "card_click",
                        "event_value": {
                            "place": "blogger",
                            "carousel_name": "For you"
                        },
                        "event_datetime": "2021-04-07 00:02:53"
                    },
                    {
                        "event_name": "card_click",
                        "event_value": {
                            "place": "blogger",
                            "carousel_name": "For you"
                        },
                        "event_datetime": "2021-04-07 00:02:54"
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "carousels_info": [
                            [
                                "main",
                                "For you",
                                null,
                                null,
                                "click",
                                1
                            ],
                            [
                                "blogger",
                                "For you",
                                null,
                                null,
                                "click",
                                2
                            ],
                            [
                                "main",
                                "For you",
                                null,
                                null,
                                "show",
                                1
                            ],
                            [
                                "movie",
                                "Recent",
                                null,
                                null,
                                "show",
                                1
                            ],
                            [
                                "movie",
                                "For you",
                                null,
                                null,
                                "show",
                                1
                            ],
                            [
                                "kids",
                                "For you",
                                null,
                                null,
                                "show",
                                1
                            ],
                            [
                                "blogger",
                                "For you",
                                1,
                                null,
                                "click",
                                1
                            ],
                            [
                                "blogger",
                                "For you",
                                1,
                                null,
                                "show",
                                1
                            ],
                            [
                                "blogger",
                                "For you",
                                null,
                                null,
                                "show",
                                2
                            ],
                            [
                                "blogger",
                                "Hits",
                                null,
                                null,
                                "show",
                                2
                            ]
                        ]
                    }
                ]
            }
        },
        {
            "test_name": "test_carousel_clicks",
            "kwargs": {
                "date": "2021-04-07"
            },
            "sources": {
                "input": [
                    {
                        "event_name": "card_click",
                        "event_value": {
                            "place": "main",
                            "carousel_name": "For you",
                            "x": 0
                        },
                        "event_datetime": "2021-04-07 00:00:30"
                    },
                    {
                        "event_name": "screen_changed",
                        "event_value": {
                            "to": "movie"
                        },
                        "event_datetime": "2021-04-07 00:00:40"
                    },
                    {
                        "event_name": "card_click",
                        "event_value": {
                            "place": "movie",
                            "carousel_name": "For you",
                            "x": 0
                        },
                        "event_datetime": "2021-04-07 00:01:30"
                    },
                    {
                        "event_name": "card_click",
                        "event_value": {
                            "place": "movie",
                            "carousel_name": "For you 1",
                            "x": 0
                        },
                        "event_datetime": "2021-04-07 00:01:35"
                    },
                    {
                        "event_name": "card_click",
                        "event_value": {
                            "place": "movie",
                            "carousel_name": "For you 1",
                            "x": 0
                        },
                        "event_datetime": "2021-04-07 00:01:35"
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "carousels_info": [
                            [
                                "main",
                                "For you",
                                null,
                                null,
                                "click",
                                1
                            ],
                            [
                                "movie",
                                "For you",
                                null,
                                null,
                                "click",
                                1
                            ],
                            [
                                "movie",
                                "For you 1",
                                null,
                                null,
                                "click",
                                2
                            ],
                            [
                                "main",
                                "For you",
                                null,
                                null,
                                "show",
                                1
                            ],
                            [
                                "movie",
                                "For you",
                                null,
                                null,
                                "show",
                                1
                            ],
                            [
                                "movie",
                                "For you 1",
                                null,
                                null,
                                "show",
                                1
                            ]
                        ]
                    }
                ]
            }
        },
        {
            "test_name": "test_carousel_shows",
            "kwargs": {
                "date": "2021-04-07"
            },
            "sources": {
                "input": [
                    {
                        "event_name": "card_show",
                        "event_value": {
                            "place": "main",
                            "carousel_name": "For you",
                            "x": 0
                        },
                        "event_datetime": "2021-04-07 00:00:30"
                    },
                    {
                        "event_name": "screen_changed",
                        "event_value": {
                            "to": "movie"
                        },
                        "event_datetime": "2021-04-07 00:00:40"
                    },
                    {
                        "event_name": "card_show",
                        "event_value": {
                            "place": "movie",
                            "carousel_name": "For you",
                            "x": 0
                        },
                        "event_datetime": "2021-04-07 00:01:30"
                    },
                    {
                        "event_name": "card_show",
                        "event_value": {
                            "place": "movie",
                            "carousel_name": "For you 1",
                            "x": 0
                        },
                        "event_datetime": "2021-04-07 00:01:35"
                    },
                    {
                        "event_name": "card_show",
                        "event_value": {
                            "place": "movie",
                            "carousel_name": "For you 1",
                            "x": 0
                        },
                        "event_datetime": "2021-04-07 00:01:35"
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "carousels_info": [
                            [
                                "main",
                                "For you",
                                null,
                                null,
                                "show",
                                1
                            ],
                            [
                                "movie",
                                "For you",
                                null,
                                null,
                                "show",
                                1
                            ],
                            [
                                "movie",
                                "For you 1",
                                null,
                                null,
                                "show",
                                1
                            ]
                        ]
                    }
                ]
            }
        },
        {
            "test_name": "test_places_info_tabs_all",
            "kwargs": {
                "date": "1970-01-01"
            },
            "sources": {
                "input": [
                    {
                        "event_timestamp": 0,
                        "event_name": "card_click",
                        "event_value": {
                            "place": "main"
                        }
                    },
                    {
                        "event_timestamp": 10,
                        "event_name": "card_click",
                        "event_value": {
                            "place": "main"
                        }
                    },
                    {
                        "event_timestamp": 20,
                        "event_name": "carousel_scroll",
                        "event_value": {
                            "place": "series"
                        }
                    },
                    {
                        "event_timestamp": 30,
                        "event_name": "card_click",
                        "event_value": {
                            "place": "main"
                        }
                    },
                    {
                        "event_timestamp": 40,
                        "event_name": "card_click",
                        "event_value": {
                            "place": "movie"
                        }
                    },
                    {
                        "event_timestamp": 45,
                        "event_name": "native_player_opened",
                        "event_value": {
                            "startup_place": {
                                "from": "movie"
                            }
                        }
                    },
                    {
                        "event_timestamp": 45,
                        "event_name": "native_player_opened",
                        "event_value": {
                            "startup_place": {
                                "from": "alice_recommendation"
                            }
                        }
                    },
                    {
                        "event_timestamp": 50,
                        "event_name": "carousel_scroll",
                        "event_value": {
                            "place": "movie"
                        }
                    },
                    {
                        "event_timestamp": 60,
                        "event_name": "card_click",
                        "event_value": {
                            "place": "movie"
                        }
                    },
                    {
                        "event_timestamp": 70,
                        "event_name": "carousel_scroll",
                        "event_value": {
                            "place": "series"
                        }
                    },
                    {
                        "event_timestamp": 80,
                        "event_name": "card_click",
                        "event_value": {
                            "place": "kids"
                        }
                    },
                    {
                        "event_timestamp": 85,
                        "event_name": "tv_player_opened",
                        "event_value": {
                            "startup_place": {
                                "from": "tv"
                            }
                        }
                    },
                    {
                        "event_timestamp": 90,
                        "event_name": "card_click",
                        "event_value": {
                            "place": "blogger"
                        }
                    },
                    {
                        "event_timestamp": 90,
                        "event_name": "card_click",
                        "event_value": {
                            "place": "alice_recommendation"
                        }
                    },
                    {
                        "event_timestamp": 100,
                        "event_name": "category_scroll",
                        "event_value": {
                            "place": "music"
                        }
                    },
                    {
                        "event_timestamp": 110,
                        "event_name": "card_click",
                        "event_value": {
                            "place": "movie"
                        }
                    },
                    {
                        "event_timestamp": 120,
                        "event_name": "card_click",
                        "event_value": {
                            "place": "search"
                        }
                    },
                    {
                        "event_timestamp": 130,
                        "event_name": "tv_channel_favorite_added",
                        "event_value": {
                            "from": "tv"
                        }
                    },
                    {
                        "event_timestamp": 135,
                        "event_name": "tv_content_changed",
                        "event_value": {}
                    },
                    {
                        "event_timestamp": 135,
                        "event_name": "music_app_launch",
                        "event_value": {}
                    },
                    {
                        "event_timestamp": 135,
                        "event_name": "app_install_page_clicked",
                        "event_value": {}
                    },
                    {
                        "event_timestamp": 135,
                        "event_name": "serp_shown",
                        "event_value": {}
                    },
                    {
                        "event_timestamp": 135,
                        "event_name": "youtube_player_opened",
                        "event_value": {
                            "startup_place": {
                                "from": "main"
                            }
                        }
                    },
                    {
                        "event_timestamp": 135,
                        "event_name": "youtube_player_opened",
                        "event_value": {
                            "startup_place": {
                                "from": "main"
                            }
                        }
                    },
                    {
                        "event_timestamp": 135,
                        "event_name": "youtube_player_opened",
                        "event_value": {
                            "startup_place": {
                                "from": "main"
                            }
                        }
                    },
                    {
                        "event_timestamp": 135,
                        "event_name": "search_content_card_opened",
                        "event_value": {
                            "startup_place": {
                                "from": "main"
                            }
                        }
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "screens_info": [
                            [
                                "main",
                                3
                            ],
                            [
                                "series",
                                2
                            ],
                            [
                                "movie",
                                2
                            ],
                            [
                                "kids",
                                1
                            ],
                            [
                                "tv",
                                2
                            ],
                            [
                                "blogger",
                                1
                            ],
                            [
                                "music",
                                1
                            ],
                            [
                                "search",
                                2
                            ],
                            [
                                "installed_apps",
                                1
                            ]
                        ]
                    }
                ]
            }
        },
        {
            "test_name": "test_places_info_tabs_only",
            "kwargs": {
                "date": "1970-01-01"
            },
            "sources": {
                "input": [
                    {
                        "event_timestamp": 0,
                        "event_name": "card_click",
                        "event_value": {
                            "place": "main"
                        }
                    },
                    {
                        "event_timestamp": 10,
                        "event_name": "card_click",
                        "event_value": {
                            "place": "main"
                        }
                    },
                    {
                        "event_timestamp": 20,
                        "event_name": "carousel_scroll",
                        "event_value": {
                            "place": "series"
                        }
                    },
                    {
                        "event_timestamp": 30,
                        "event_name": "card_click",
                        "event_value": {
                            "place": "main"
                        }
                    },
                    {
                        "event_timestamp": 40,
                        "event_name": "card_click",
                        "event_value": {
                            "place": "movie"
                        }
                    },
                    {
                        "event_timestamp": 50,
                        "event_name": "carousel_scroll",
                        "event_value": {
                            "place": "movie"
                        }
                    },
                    {
                        "event_timestamp": 60,
                        "event_name": "card_click",
                        "event_value": {
                            "place": "movie"
                        }
                    },
                    {
                        "event_timestamp": 70,
                        "event_name": "carousel_scroll",
                        "event_value": {
                            "place": "series"
                        }
                    },
                    {
                        "event_timestamp": 80,
                        "event_name": "card_click",
                        "event_value": {
                            "place": "kids"
                        }
                    },
                    {
                        "event_timestamp": 90,
                        "event_name": "card_click",
                        "event_value": {
                            "place": "blogger"
                        }
                    },
                    {
                        "event_timestamp": 100,
                        "event_name": "category_scroll",
                        "event_value": {
                            "place": "music"
                        }
                    },
                    {
                        "event_timestamp": 110,
                        "event_name": "card_click",
                        "event_value": {
                            "place": "movie"
                        }
                    },
                    {
                        "event_timestamp": 120,
                        "event_name": "card_click",
                        "event_value": {
                            "place": "search"
                        }
                    },
                    {
                        "event_timestamp": 130,
                        "event_name": "tv_channel_favorite_added",
                        "event_value": {
                            "place": "tv"
                        }
                    },
                    {
                        "event_timestamp": 130,
                        "event_name": "tv_channel_favorite_added",
                        "event_value": {
                            "place": "tv"
                        }
                    },
                    {
                        "event_timestamp": 130,
                        "event_name": "session_init",
                        "event_value": {}
                    },
                    {
                        "event_timestamp": 130,
                        "event_name": "tv_channel_favorite_added",
                        "event_value": {
                            "place": "tv"
                        }
                    },
                    {
                        "event_timestamp": 130,
                        "event_name": "tv_player_opened",
                        "event_value": {
                            "startup_place": {
                                "from": "main"
                            }
                        }
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "screens_info": [
                            [
                                "main",
                                3
                            ],
                            [
                                "series",
                                2
                            ],
                            [
                                "movie",
                                2
                            ],
                            [
                                "kids",
                                1
                            ],
                            [
                                "blogger",
                                1
                            ],
                            [
                                "music",
                                1
                            ],
                            [
                                "search",
                                1
                            ],
                            [
                                "tv",
                                3
                            ]
                        ]
                    }
                ]
            }
        },
        {
            "test_name": "test_places_info_youtube",
            "kwargs": {
                "date": "1970-01-01"
            },
            "sources": {
                "input": [
                    {
                        "event_timestamp": 0,
                        "event_name": "session_init",
                        "event_value": {}
                    },
                    {
                        "event_timestamp": 2,
                        "event_name": "card_click",
                        "event_value": {
                            "place": "main"
                        }
                    },
                    {
                        "event_timestamp": 5,
                        "event_name": "card_click",
                        "event_value": {
                            "place": "main"
                        }
                    },
                    {
                        "event_timestamp": 10,
                        "event_name": "youtube_player_action",
                        "event_value": {}
                    },
                    {
                        "event_timestamp": 20,
                        "event_name": "youtube_player_opened",
                        "event_value": {
                            "startup_place": {
                                "from": "main"
                            }
                        }
                    },
                    {
                        "event_timestamp": 30,
                        "event_name": "youtube_player_action",
                        "event_value": {}
                    },
                    {
                        "event_timestamp": 40,
                        "event_name": "youtube_player_opened",
                        "event_value": {
                            "startup_place": {
                                "from": "main"
                            }
                        }
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "screens_info": [
                            [
                                "main",
                                1
                            ]
                        ]
                    }
                ]
            }
        },
        {
            "test_name": "test_screens_zero_active",
            "kwargs": {
                "date": "1970-01-01"
            },
            "sources": {
                "input": [
                    {
                        "event_timestamp": 0,
                        "event_name": "screen_changed",
                        "event_value": {
                            "from": "main",
                            "to": "movie"
                        }
                    },
                    {
                        "event_timestamp": 10,
                        "event_name": "screen_changed",
                        "event_value": {
                            "from": "movie",
                            "to": "series"
                        }
                    },
                    {
                        "event_timestamp": 20,
                        "event_name": "screen_changed",
                        "event_value": {
                            "from": "series",
                            "to": "kids"
                        }
                    },
                    {
                        "event_timestamp": 30,
                        "tv_debug_log": "screen_changed",
                        "event_value": {
                            "from": "kids",
                            "to": "blogger"
                        }
                    },
                    {
                        "event_timestamp": 40,
                        "event_name": "screen_changed",
                        "event_value": {
                            "from": "blogger",
                            "to": "search"
                        }
                    },
                    {
                        "event_timestamp": 50,
                        "event_name": "screen_changed",
                        "event_value": {
                            "from": "search",
                            "to": "main"
                        }
                    },
                    {
                        "event_timestamp": 60,
                        "event_name": "screen_changed",
                        "event_value": {
                            "from": "main",
                            "to": "search"
                        }
                    },
                    {
                        "event_timestamp": 70,
                        "experimets": "screen_changed",
                        "event_value": {
                            "from": "search",
                            "to": "kids"
                        }
                    },
                    {
                        "event_timestamp": 80,
                        "event_name": "screen_changed",
                        "event_value": {
                            "from": "kids",
                            "to": "movie"
                        }
                    },
                    {
                        "event_timestamp": 90,
                        "event_name": "screen_changed",
                        "event_value": {
                            "from": "movie",
                            "to": "main"
                        }
                    },
                    {
                        "event_timestamp": 100,
                        "event_name": "screen_changed",
                        "event_value": {
                            "from": "main",
                            "to": "movie"
                        }
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "screens_info": [
                        ]
                    }
                ]
            }
        },
        {
            "test_name": "test_quasas_device_id",
            "kwargs": {
                "date": "2021-04-07"
            },
            "sources": {
                "input": [
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:30",
                        "device_id": 1,
                        "quasar_device_id": "ba"
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:30",
                        "device_id": 1,
                        "quasar_device_id": "ab"
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:30",
                        "device_id": 1,
                        "quasar_device_id": "ab"
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:30",
                        "device_id": 1,
                        "quasar_device_id": null
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:30",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:01:00",
                        "device_id": 2
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "quasar_device_id": null,
                        "device_id": 2
                    },
                    {
                        "quasar_device_id": "ab",
                        "device_id": 1
                    }
                ]
            }
        },
        {
            "test_name": "test_login_plus_gift",
            "kwargs": {
                "date": "2021-04-07"
            },
            "sources": {
                "input": [
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:30",
                        "device_id": 1,
                        "puid": "123",
                        "is_logged_in": true
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:30",
                        "device_id": 1,
                        "puid": null
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:30",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:30",
                        "device_id": 2,
                        "has_plus": true
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:30",
                        "device_id": 3,
                        "active_tv_gift": true
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "device_id": 1,
                        "is_logged_in": true,
                        "has_plus": false,
                        "active_tv_gift": false
                    },
                    {
                        "device_id": 2,
                        "is_logged_in": false,
                        "has_plus": true,
                        "active_tv_gift": false
                    },
                    {
                        "device_id": 3,
                        "is_logged_in": false,
                        "has_plus": false,
                        "active_tv_gift": true
                    }
                ]
            }
        },
        {
            "test_name": "test_login_timestamps",
            "kwargs": {
                "date": "1970-01-01"
            },
            "sources": {
                "input": [
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_timestamp": 0,
                        "device_id": 1,
                        "puid": "123",
                        "is_logged_in": true,
                        "has_plus": false
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_timestamp": 10,
                        "device_id": 1,
                        "puid": "123",
                        "is_logged_in": true,
                        "has_plus": true
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_timestamp": 20,
                        "device_id": 1,
                        "is_logged_in": false,
                        "has_plus": false
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_timestamp": 30,
                        "device_id": 2,
                        "is_logged_in": false,
                        "active_tv_gift": false
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_timestamp": 35,
                        "device_id": 2,
                        "is_logged_in": false,
                        "active_tv_gift": true
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_timestamp": 40,
                        "device_id": 3,
                        "is_logged_in": false
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "device_id": 1,
                        "puids": {
                            "0": "123",
                            "20": null
                        },
                        "pluses": {
                            "0": false,
                            "10": true,
                            "20": false
                        }
                    },
                    {
                        "device_id": 2,
                        "puids": {
                            "30": null
                        },
                        "gifts": {
                            "30": false,
                            "35": true
                        }
                    },
                    {
                        "device_id": 3,
                        "puids": {
                            "40": null
                        }
                    }
                ]
            }
        },
        {
            "test_name": "test_screen_time",
            "kwargs": {
                "date": "1970-01-01"
            },
            "sources": {
                "input": [
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {},
                        "event_timestamp": 0,
                        "device_id": 1,
                        "session_id": 1
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {},
                        "event_timestamp": 10,
                        "device_id": 1,
                        "session_id": 1
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {},
                        "event_timestamp": 20,
                        "device_id": 1,
                        "session_id": 2
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {},
                        "event_timestamp": 30,
                        "device_id": 1,
                        "session_id": 2
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {},
                        "event_timestamp": 40,
                        "device_id": 1,
                        "session_id": 2
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {},
                        "event_timestamp": 50,
                        "device_id": 2,
                        "session_id": 1
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {},
                        "event_timestamp": 60,
                        "device_id": 2,
                        "session_id": 1
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {},
                        "event_timestamp": 70,
                        "device_id": 3,
                        "session_id": 1
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "device_id": 1,
                        "screen_time": 30
                    },
                    {
                        "device_id": 2,
                        "screen_time": 10
                    },
                    {
                        "device_id": 3,
                        "screen_time": 0
                    }
                ]
            }
        },
        {
            "test_name": "test_screen_saver_stats",
            "kwargs": {
                "date": "2021-04-08"
            },
            "sources": {
                "input": [
                    {
                        "event_datetime": "2021-04-06 23:59:00",
                        "event_name": "screensaver_stats",
                        "event_value": {
                            "period": 100
                        },
                        "device_id": 1,
                        "session_id": 1
                    },
                    {
                        "event_datetime": "2021-04-07 00:00:30",
                        "event_name": "screensaver_stats",
                        "event_value": {
                            "period": 40
                        },
                        "device_id": 1,
                        "session_id": 1
                    },
                    {
                        "event_datetime": "2021-04-07 01:00:30",
                        "event_name": "screensaver_stats",
                        "event_value": {
                            "period": 30
                        },
                        "device_id": 1,
                        "session_id": 2
                    },
                    {
                        "event_datetime": "2021-04-07 02:00:30",
                        "event_name": "screensaver_stats",
                        "event_value": {
                            "period": 20
                        },
                        "device_id": 1,
                        "session_id": 2
                    },
                    {
                        "event_datetime": "2021-04-07 03:00:30",
                        "event_name": "screensaver_stats",
                        "event_value": {
                            "period": 10
                        },
                        "device_id": 1,
                        "session_id": 2
                    },
                    {
                        "event_datetime": "2021-04-07 23:50:30",
                        "event_name": "screensaver_stats",
                        "event_value": {
                            "period": 100
                        },
                        "device_id": 1,
                        "session_id": 1
                    },
                    {
                        "event_datetime": "2021-04-08 00:00:30",
                        "event_name": "screensaver_stats",
                        "event_value": {
                            "period": 50.1
                        },
                        "device_id": 1,
                        "session_id": 1
                    },
                    {
                        "event_datetime": "2021-04-08 00:01:30",
                        "event_name": "screensaver_stats",
                        "event_value": {
                            "period": 60
                        },
                        "device_id": 1,
                        "session_id": 1
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "fielddate": "2021-04-06",
                        "device_id": 1,
                        "screen_saver_time": 110
                    },
                    {
                        "fielddate": "2021-04-07",
                        "device_id": 1,
                        "screen_saver_time": 210
                    },
                    {
                        "fielddate": "2021-04-08",
                        "device_id": 1,
                        "screen_saver_time": 90
                    }
                ]
            }
        },
        {
            "test_name": "test_apps_versions",
            "kwargs": {
                "date": "2021-04-07"
            },
            "sources": {
                "input": [
                    {
                        "event_datetime": "2021-04-07 00:00:30",
                        "event_name": "session_init",
                        "event_value": {
                            "apps_versions": {
                                "home_app": "1.4"
                            }
                        },
                        "device_id": 1,
                        "session_id": 1,
                        "apps_versions": {
                            "home_app": "1.4"
                        }
                    },
                    {
                        "event_datetime": "2021-04-07 01:00:30",
                        "event_name": "screensaver_stats",
                        "event_value": {
                            "period": 30
                        },
                        "device_id": 1,
                        "session_id": 2,
                        "apps_versions": {
                            "home_app": "1.4"
                        }
                    },
                    {
                        "event_datetime": "2021-04-07 02:00:30",
                        "event_name": "screensaver_stats",
                        "event_value": {
                            "period": 20
                        },
                        "device_id": 1,
                        "session_id": 2,
                        "apps_versions": {
                            "home_app": "1.4"
                        }
                    },
                    {
                        "event_datetime": "2021-04-07 03:00:30",
                        "event_name": "session_init",
                        "event_value": {
                            "apps_versions": {
                                "home_app": "1.5"
                            }
                        },
                        "device_id": 1,
                        "session_id": 2,
                        "apps_versions": {
                            "home_app": "1.4"
                        }
                    },
                    {
                        "event_datetime": "2021-04-07 23:50:30",
                        "event_name": "screensaver_stats",
                        "event_value": {
                            "period": 100
                        },
                        "device_id": 1,
                        "session_id": 1,
                        "apps_versions": {
                            "home_app": "1.4"
                        }
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "fielddate": "2021-04-07",
                        "device_id": 1,
                        "apps_versions": {
                            "home_app": "1.5"
                        }
                    }
                ]
            }
        },
        {
            "test_name": "test_apps_timespent",
            "kwargs": {
                "date": "2021-06-20"
            },
            "sources": {
                "input": [
                    {
                        "event_datetime": "2021-06-20 12:00:00",
                        "event_name": "apps_time_spent_info",
                        "event_value": {
                            "apps": {
                                "youtube": "200",
                                "tv_channels": "40",
                                "music": "380"
                            }
                        },
                        "device_id": 1,
                        "event_timestamp": 1624179600
                    },
                    {
                        "event_datetime": "2021-06-20 12:00:01",
                        "event_name": "apps_time_spent_info",
                        "event_value": {
                            "apps": {}
                        },
                        "device_id": 1,
                        "event_timestamp": 1624179601
                    },
                    {
                        "event_datetime": "2021-06-20 12:00:02",
                        "event_name": "apps_time_spent_info",
                        "event_value": {
                            "apps": {
                                "youtube": "200",
                                "tv_channels": "80",
                                "some_app": "400"
                            }
                        },
                        "device_id": 1,
                        "event_timestamp": 1624179602
                    },
                    {
                        "event_datetime": "2021-06-20 12:00:03",
                        "event_name": "apps_time_spent_info",
                        "event_value": {
                            "apps": {
                                "youtube": "220",
                                "tv_channels": "80",
                                "music": "380"
                            }
                        },
                        "device_id": 1,
                        "event_timestamp": 1624179603
                    },
                    {
                        "event_datetime": "2021-06-20 12:00:01",
                        "event_name": "apps_time_spent_info",
                        "event_value": {
                            "apps": {}
                        },
                        "device_id": 2,
                        "event_timestamp": 1624179601
                    },
                    {
                        "event_datetime": "2021-06-20 12:00:02",
                        "event_name": "apps_time_spent_info",
                        "event_value": {
                            "apps": {
                                "youtube": "220",
                                "tv_channels": "80",
                                "music": "380"
                            }
                        },
                        "device_id": 2,
                        "event_timestamp": 1624179602
                    },
                    {
                        "event_datetime": "2021-06-20 12:00:03",
                        "event_name": "apps_time_spent_info",
                        "event_value": {
                            "apps": {
                                "youtube": "0",
                                "tv_channels": "80",
                                "music": "1000",
                                "some_app": "666"
                            }
                        },
                        "device_id": 2,
                        "event_timestamp": 1624179603
                    },
                    {
                        "event_datetime": "2021-06-20 12:00:03",
                        "event_name": "apps_time_spent_info",
                        "event_value": {
                            "youtube": "0",
                            "tv_channels": "80",
                            "music": "1000",
                            "some_app": "666"
                        },
                        "device_id": 3,
                        "event_timestamp": 1624179603
                    },
                    {
                        "event_datetime": "2021-06-20 12:00:04",
                        "event_name": "apps_time_spent_info",
                        "event_value": {
                            "youtube": "2",
                            "tv_channels": "80",
                            "some_another_app": "666"
                        },
                        "device_id": 3,
                        "event_timestamp": 1624179604
                    },
                    {
                        "event_datetime": "2021-06-20 12:00:05",
                        "event_name": "apps_time_spent_info",
                        "event_value": {
                            "youtube": {
                                "activity": "12"
                            }
                        },
                        "device_id": 3,
                        "event_timestamp": 1624179605
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "fielddate": "2021-06-20",
                        "device_id": 1,
                        "apps_timespent": {
                            "youtube": 420,
                            "tv_channels": 120,
                            "music": 380,
                            "some_app": 400
                        }
                    },
                    {
                        "fielddate": "2021-06-20",
                        "device_id": 2,
                        "apps_timespent": {
                            "youtube": 220,
                            "tv_channels": 80,
                            "music": 1380,
                            "some_app": 666
                        }
                    },
                    {
                        "fielddate": "2021-06-20",
                        "device_id": 3,
                        "apps_timespent": {
                            "youtube": 2,
                            "tv_channels": 80,
                            "music": 1000,
                            "some_app": 666,
                            "some_another_app": 666
                        }
                    }
                ]
            }
        },
        {
            "test_name": "test_paid_plus",
            "kwargs": {
                "date": "2021-04-07"
            },
            "sources": {
                "input": [
                    {
                        "event_datetime": "2021-04-07 00:00:30",
                        "has_paid_plus": false,
                        "event_name": "session_init",
                        "event_value": {
                            "apps_versions": {
                                "home_app": "1.4"
                            }
                        },
                        "device_id": 1,
                        "session_id": 1
                    },
                    {
                        "event_datetime": "2021-04-07 01:00:30",
                        "has_paid_plus": true,
                        "event_name": "screensaver_stats",
                        "event_value": {
                            "period": 30
                        },
                        "device_id": 1,
                        "session_id": 2
                    },
                    {
                        "event_datetime": "2021-04-07 02:00:30",
                        "has_paid_plus": false,
                        "event_name": "screensaver_stats",
                        "event_value": {
                            "period": 20
                        },
                        "device_id": 1,
                        "session_id": 3
                    },
                    {
                        "event_datetime": "2021-04-07 03:00:30",
                        "has_paid_plus": false,
                        "event_name": "session_init",
                        "event_value": {
                            "apps_versions": {
                                "home_app": "1.5"
                            }
                        },
                        "device_id": 2,
                        "session_id": 2
                    },
                    {
                        "event_datetime": "2021-04-07 23:50:30",
                        "has_paid_plus": true,
                        "event_name": "screensaver_stats",
                        "event_value": {
                            "period": 100
                        },
                        "device_id": 3,
                        "session_id": 3
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "fielddate": "2021-04-07",
                        "device_id": 1,
                        "has_paid_plus": true
                    },
                    {
                        "fielddate": "2021-04-07",
                        "device_id": 2,
                        "has_paid_plus": false
                    },
                    {
                        "fielddate": "2021-04-07",
                        "device_id": 3,
                        "has_paid_plus": true
                    }
                ]
            }
        },
        {
            "test_name": "test_tandem_connection_state",
            "date": "2021-04-07",
            "sources": {
                "input": [
                    {
                        "event_datetime": "2021-04-07 00:00:30",
                        "tandem_connection_state": "1",
                        "event_name": "session_init",
                        "device_id": 1,
                        "session_id": 1
                    },
                    {
                        "event_datetime": "2021-04-07 01:00:30",
                        "tandem_connection_state": "",
                        "event_name": "screensaver_stats",
                        "device_id": 1,
                        "session_id": 2
                    },
                    {
                        "event_datetime": "2021-04-07 02:00:30",
                        "event_name": "screensaver_stats",
                        "event_value": {
                            "period": 20
                        },
                        "device_id": 1,
                        "session_id": 3
                    },
                    {
                        "event_datetime": "2021-04-07 03:00:30",
                        "tandem_connection_state": "0",
                        "event_name": "session_init",
                        "device_id": 2,
                        "session_id": 2
                    },
                    {
                        "event_datetime": "2021-04-07 23:50:30",
                        "event_name": "screensaver_stats",
                        "event_value": {
                            "period": 100
                        },
                        "device_id": 3,
                        "session_id": 3
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "fielddate": "2021-04-07",
                        "device_id": 1,
                        "tandem_connection_state": "1"
                    },
                    {
                        "fielddate": "2021-04-07",
                        "device_id": 2,
                        "tandem_connection_state": "0"
                    },
                    {
                        "fielddate": "2021-04-07",
                        "device_id": 3,
                        "tandem_connection_state": ""
                    }
                ]
            }
        },
        {
            "test_name": "test_tandem_info",
            "sources": {
                "input": [
                    {
                        "event_datetime": "2021-04-07 00:00:30",
                        "tandem_connection_state": "1",
                        "tandem_device_id": "1",
                        "event_name": "session_init",
                        "device_id": 1,
                        "session_id": 1
                    },
                    {
                        "event_datetime": "2021-04-07 01:00:30",
                        "event_name": "screensaver_stats",
                        "event_value": {
                            "period": 30
                        },
                        "device_id": 1,
                        "session_id": 2
                    },
                    {
                        "event_datetime": "2021-04-07 02:00:30",
                        "event_name": "screensaver_stats",
                        "event_value": {
                            "period": 20
                        },
                        "device_id": 1,
                        "session_id": 3
                    },
                    {
                        "event_datetime": "2021-04-07 03:00:30",
                        "tandem_connection_state": "0",
                        "tandem_device_id": "2",
                        "event_name": "session_init",
                        "device_id": 2,
                        "session_id": 2
                    },
                    {
                        "event_datetime": "2021-04-07 23:50:30",
                        "event_name": "screensaver_stats",
                        "event_value": {
                            "period": 100
                        },
                        "device_id": 3,
                        "session_id": 3
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "fielddate": "2021-04-07",
                        "device_id": 1,
                        "tandem_info": {
                            "1": "1"
                        }
                    },
                    {
                        "fielddate": "2021-04-07",
                        "device_id": 2,
                        "tandem_info": {
                            "2": "0"
                        }
                    },
                    {
                        "fielddate": "2021-04-07",
                        "device_id": 3
                    }
                ]
            }
        },
        {
            "test_name": "test_wlan",
            "date": "2021-04-07",
            "sources": {
                "input": [
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:30",
                        "device_id": 1,
                        "wlan0": "123"
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "hdmi_timespent": [
                            [
                                "undefined_device",
                                "undefined_port",
                                30
                            ]
                        ],
                        "device_id": 1,
                        "wlan0": "123"
                    }
                ]
            }
        },
        {
            "test_name": "test_mac",
            "date": "2021-04-07",
            "sources": {
                "input": [
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "event_datetime": "2021-04-07 00:00:30",
                        "device_id": 1,
                        "mac_id": "123"
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "hdmi_timespent": [
                            [
                                "undefined_device",
                                "undefined_port",
                                30
                            ]
                        ],
                        "device_id": 1,
                        "mac_id": "123"
                    }
                ]
            }
        },
        {
            "test_name": "test_ads_delay_duration",
            "date": "2021-04-07",
            "sources": {
                "input": [
                    {
                        "event_datetime": "2021-04-07 00:00:30",
                        "event_name": "ad_preroll_start_delay",
                        "event_value": {
                            "duration_ms": 1000
                        },
                        "device_id": 1,
                        "session_id": 1
                    },
                    {
                        "event_datetime": "2021-04-07 00:00:30",
                        "event_name": "ad_preroll_start_delay",
                        "event_value": {
                            "duration_ms": 2000
                        },
                        "device_id": 1,
                        "session_id": 1
                    },
                    {
                        "event_datetime": "2021-04-07 00:00:30",
                        "event_name": "ad_preroll_start_delay",
                        "event_value": {
                            "duration_ms": 2147483647
                        },
                        "device_id": 1,
                        "session_id": 1
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "fielddate": "2021-04-07",
                        "device_id": 1,
                        "ads_delay_duration_ms": 3000,
                        "ads_preroll_count": 3
                    }
                ]
            }
        },
        {
            "test_name": "test_activations",
            "date": "2021-04-07",
            "sources": {
                "input": [
                    {
                        "event_datetime": "2021-04-07 00:00:30",
                        "event_name": "tv_player_heartbeat",
                        "event_value": {},
                        "device_id": 1,
                        "eth0": "1",
                        "quasar_device_id": "2",
                        "session_id": 1
                    },
                    {
                        "event_datetime": "2021-04-07 00:00:30",
                        "event_name": "tv_player_heartbeat",
                        "event_value": {},
                        "device_id": 2,
                        "eth0": null,
                        "quasar_device_id": "2",
                        "session_id": 1
                    },
                    {
                        "event_datetime": "2021-04-07 00:00:30",
                        "event_name": "tv_player_heartbeat",
                        "event_value": {},
                        "device_id": 3,
                        "eth0": null,
                        "quasar_device_id": null,
                        "session_id": 1
                    }
                ],
                "activations": [
                    {"activation_id": "1", "activation_date": "2021-04-01"},
                    {"activation_id": "2", "activation_date": "2021-03-01"}
                ]
            },
            "sinks": {
                "output": [
                    {
                        "fielddate": "2021-04-07",
                        "device_id": 3,
                        "activation_id": null,
                        "is_new": null
                    },
                    {
                        "fielddate": "2021-04-07",
                        "device_id": 1,
                        "activation_id": "1",
                        "activation_date": "2021-04-01",
                        "is_new": true
                    },
                    {
                        "fielddate": "2021-04-07",
                        "device_id": 2,
                        "activation_id": "2",
                        "activation_date": "2021-03-01",
                        "is_new": false
                    }
                ]
            }
        },
        {
            "test_name": "test_active_other_trial",
            "kwargs": {
                "date": "2021-04-07"
            },
            "sources": {
                "input": [
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "1"
                        },
                        "active_other_trial": true,
                        "event_datetime": "2021-04-07 00:00:30",
                        "device_id": 1
                    },
                    {
                        "event_name": "hdmi_heartbeat",
                        "event_value": {
                            "period": 30,
                            "hdmi_session_id": "2"
                        },
                        "active_other_trial": null,
                        "event_datetime": "2021-04-07 00:02:30",
                        "device_id": 2
                    }
                ]
            },
            "sinks": {
                "output": [
                    {
                        "active_other_trial": true,
                        "device_id": 1
                    },
                    {
                        "active_other_trial": false,
                        "device_id": 2
                    }
                ]
            }
        }
    ]
}
